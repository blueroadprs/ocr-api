function extraerTextoConMicroservicio(blob) {
  const url = 'https://TU_MICROSERVICIO/ocr'; // <-- tu URL

  const formData = {
    method: 'post',
    payload: {
      file: blob
    },
    muteHttpExceptions: true
  };

  const response = UrlFetchApp.fetch(url, formData);
  const resultado = JSON.parse(response.getContentText());

  if (resultado.text) return resultado.text;
  else throw new Error("OCR fallÃ³: " + response.getContentText());
}
